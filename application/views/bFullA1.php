<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>超パーソナルライズド</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.7 -->
    <link rel="stylesheet" href='<?php echo base_url() ?>assets/boostrap/css/bootstrap.css'>
    <link rel="stylesheet" href='<?php echo base_url() ?>assets/boostrap/css/bootstrap-year-calendar.css'>
    <!-- Font Awesome -->
    <link rel="stylesheet" href='<?php echo base_url() ?>assets/font-awesome/css/font-awesome.min.css'>
    <!-- Ionicons -->
    <link rel="stylesheet" href='<?php echo base_url() ?>assets/Ionicons/css/ionicons.min.css'>
    <!-- Theme style -->
    <link rel="stylesheet" href='<?php echo base_url() ?>assets/css/AdminLTE.css'>
    <!-- AdminLTE Skins. Choose a skin from the css/skins
         folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" href='<?php echo base_url() ?>assets/css/skins/_all-skins.min.css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="../assets/jquery/jquery.ui.touch-punch.min.js"></script>

    <script src='<?php echo base_url() ?>assets/boostrap/js/bootstrap-year-calendar.js'></script>

    <!-- Google Font -->
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">
</head>
<!-- ADD THE CLASS layout-top-nav TO REMOVE THE SIDEBAR. -->
<body class="hold-transition skin-blue layout-top-nav">
<div class="wrapper">
    <!-- Full Width Column -->
    <div class="content-wrapper">
        <div class="container">
            <!-- Main content -->
            <section class="content">
                <div id="calendar-action" class="row row-centered" style="padding-left: 0px; padding-bottom: 0px">
                    <div class="col-md-12">
                        <div class="col-md-9 body-img" id="calendar-head">
                            <div class="col-x">
                                <div class="img-droppable" id="a-full-img1">
                                    <img class="w-img-menu"
                                         src="https://media2.fdncms.com/orlando/imager/you-guys-theres-a-backstreet-boys-movie/u/blog/2322274/backstreet-boys-4fe94c3a30161.jpg?cb=1454770342"
                                         alt="Photo">
                                </div>

                                <div class="row" style="margin-left: 0px; margin-right: 0px;">
                                    <div class="col-z">
                                        <div class="img-droppable" id="a-full-img5">
                                            <img class="w-img-menu"
                                                 src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ6ZmUwhMVK1djjFHFJk3ry9o7BMfkuW87K_4MWK45kfaidG_As"
                                                 alt="Photo">
                                        </div>
                                    </div>
                                    <!-- /.col -->
                                    <div class="col-z">
                                        <div class="img-droppable" id="a-full-img6">
                                            <img class="w-img-menu"
                                                 src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ6ZmUwhMVK1djjFHFJk3ry9o7BMfkuW87K_4MWK45kfaidG_As"
                                                 alt="Photo">
                                        </div>
                                    </div>
                                    <!-- /.col -->

                                    <!-- fix for small devices only -->
                                    <!-- <div class="clearfix visible-sm-block"></div> -->

                                    <div class="col-z">
                                        <div class="img-droppable" id="a-full-img7">
                                            <img class="w-img-menu"
                                                 src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ6ZmUwhMVK1djjFHFJk3ry9o7BMfkuW87K_4MWK45kfaidG_As"
                                                 alt="Photo">
                                        </div>
                                    </div>
                                </div>

                                <div class="row" style="margin-left: 0px; margin-right: 0px;">
                                    <div class="col-z">
                                        <div class="img-droppable" id="a-full-img8">
                                            <img class="w-img-menu"
                                                 src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ6ZmUwhMVK1djjFHFJk3ry9o7BMfkuW87K_4MWK45kfaidG_As"
                                                 alt="Photo">
                                        </div>
                                    </div>
                                    <!-- /.col -->
                                    <div class="col-z">
                                        <div class="img-droppable" id="a-full-img9">
                                            <img class="w-img-menu"
                                                 src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ6ZmUwhMVK1djjFHFJk3ry9o7BMfkuW87K_4MWK45kfaidG_As"
                                                 alt="Photo">
                                        </div>
                                    </div>
                                    <!-- /.col -->

                                    <!-- fix for small devices only -->
                                    <!-- <div class="clearfix visible-sm-block"></div> -->

                                    <div class="col-z">
                                        <div class="img-droppable" id="a-full-img10">
                                            <img class="w-img-menu"
                                                 src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ6ZmUwhMVK1djjFHFJk3ry9o7BMfkuW87K_4MWK45kfaidG_As"
                                                 alt="Photo">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-y">
                                <div class="img-droppable" id="a-full-img2">
                                    <img class="w-img-menu"
                                         src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ6ZmUwhMVK1djjFHFJk3ry9o7BMfkuW87K_4MWK45kfaidG_As"
                                         alt="Photo">
                                </div>
                                <div class="img-droppable" id="a-full-img3">
                                    <img class="w-img-menu"
                                         src="https://t2.genius.com/unsafe/220x220/https%3A%2F%2Fimages.genius.com%2Fd5f35f8f0a6527791a21a58e077a552f.650x650x1.jpg"
                                         alt="Photo">
                                </div>
                                <div class="img-droppable" id="a-full-img4">
                                    <img class="w-img-menu"
                                         src="https://t2.genius.com/unsafe/220x220/https%3A%2F%2Fimages.genius.com%2Fc50e1b7be0ef24d3278e0c10ea8ea388.350x350x1.png"
                                         alt="Photo">
                                </div>
                            </div>

                        </div>

                        <div class="col-md-3" style="padding: 0px">
                            <div class="box box-solid" style="padding-left: 2px;">
                                <a class="btn btn-block w-btn-ch btn-bit" style="margin: 0px;">
                                    <i class="fa fa-caret-down"></i>Thumbnail
                                </a>
                                <div class="box-body" id="thumbnailContent">
                                    <div class="btn-group" style="width: 100%; margin-bottom: 10px;">
                                        <!--<button type="button" id="color-chooser-btn" class="btn btn-info btn-block dropdown-toggle" data-toggle="dropdown">Color <span class="caret"></span></button>-->
                                        <ul class="fc-color-picker" id="color-chooser">
                                            <?php
                                            $num = count($images) < 50 ? count($images) : 50;
                                            for ($i = 0; $i < $num; $i++) : ?>
                                                <div class="box-image">
                                                    <img class="img-picker" id="img-picker-<?php echo $i; ?>"
                                                         src= <?php echo $images[$i]; ?>
                                                         alt="Photo">
                                                    <button type="button" class="btn btn-primary img-plus"
                                                            data-widget="collapse" data-toggle="tooltip" title=""
                                                            style="margin-right: 5px;" data-original-title="Collapse">
                                                        <i class="fa fa-plus"></i></button>
                                                </div>
                                            <?php endfor; ?>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-9 choose-action" style="left: 0; right: 0">
                            <button type="button" id="btn-payment"
                                    onclick="window.location.href='../contact-info'"
                                    class="btn btn-success"><?php echo lang('d_payment') ?></button>

                            <button type="button" id="btn-preview"
                                    class="btn btn-warning"><?php echo lang('d_preview') ?></button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- /.content -->
        </div>
        <!-- /.container -->
    </div>
    

    <!-- /.content-wrapper -->
    <footer class="main-footer">
        <div class="container">
            <div class="pull-right hidden-xs">
                <b>Version</b> 1.0
            </div>
            <strong>COPYRIGHT &copy; <?php echo date('Y') ?> Reserved by Libertybell.</strong>
        </div>
        <!-- /.container -->
    </footer>
</div>
<!-- ./wrapper -->

<!-- The Modal -->
<div id="modalCalendar" class="modal">
<!-- Modal content -->
    <div class="modal-content">
        <div class="modal-header">
            <span class="close">&times;</span>
        </div>

        <div id="calendar-preview" class="row row-centered">
            <div class="col-md-12" id="pre-calendar-head">
                <!-- Calendar head here! -->

                <h1 style="text-align:center">BackStreet Boys</h1>

                <div class="row">
                    <div class="col-md-12" style="display: inline-flex;padding:15px 30px">
                        <div id="calendar">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- The Modal -->
<div id="modalThumbnail" class="modal">
    <!-- Modal content -->
    <div class="modal-content" style="width: 64%;">
        <div class="modal-header">
            <span class="close">&times;</span>
        </div>
    </div>
</div>

<div id="modalImage" class="modal">
    <!-- Modal content -->
    <div class="modal-content">
        <div class="modal-header">
            <span class="close">&times;</span>
        </div>

        <div id="calendar-preview" class="row row-centered">
            <div class="col-md-12" id="pre-calendar-head">
                <div class="btn-group" style="width: 100%; margin-bottom: 10px;">
                    <!--<button type="button" id="color-chooser-btn" class="btn btn-info btn-block dropdown-toggle" data-toggle="dropdown">Color <span class="caret"></span></button>-->
                    <ul class="fc-color-picker" id="color-chooser">
                        <?php foreach ($images as $img): ?>
                            <img class="img-choose"
                                src= <?php echo $img; ?>
                                alt="Photo">
                        <?php endforeach; ?>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    var today = new Date();
    var year = today.getFullYear();
    // Get the modal
    var modalCalendar = $("#modalCalendar");
    var modalThumbnail = $("#modalThumbnail");
    var modalImage = $("#modalImage");

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];
    var span2 = document.getElementsByClassName("close")[1];
    var span3 = document.getElementsByClassName("close")[2];

    $(function () {
        var currentYear = new Date().getFullYear();

        $('#calendar').calendar({
            enableContextMenu: false,
            enableRangeSelection: false,
        });
    });

    $(".img-picker").draggable({revert: true, revertDuration: 0});
    $(".img-droppable").droppable({
        drop: function (event, ui) {
            var draggable = ui.draggable;
            //console.log(draggable);
            $(this)
                .find("img")
                .attr('src', draggable.context.currentSrc);
        }
    });

    // When the user clicks on the button, open the modal 
    $("#btn-preview").click(function () {
        // Copy div.#calendar-head
        if (modalCalendar.find("#calendar-head").length == 0) {
            $("#pre-calendar-head").prepend($("#calendar-head").clone());
        } else {
            $("#pre-calendar-head #calendar-head").replaceWith($("#calendar-action #calendar-head").clone());
        }
        $('#pre-calendar-head #calendar-head').addClass('col-md-12').removeClass('col-md-9');
        modalCalendar.css("display", "block");
    });
    

    // When the user clicks on the button, open the modal
    $(".img-plus").click(function () {
        var id = $(this).parent().find('.img-picker').attr("id")
        modalImage.css("display", "block");
        $(".img-choose").attr("onclick", "setImageChoose('" + id + "', this);");
    });

    $("#btn-payment").click(function () {
        $.ajax({
            type: "POST",
            crossDomain: true,
            async: false,
            url: '<?php echo base_url() ?>payment',
            data: JSON.stringify({"type": "a-black"}),
            dataType: 'application/json'
        });

        $.ajax({
            method: "POST",
            url: '<?php echo base_url() ?>index.php/pages/index',
            data: {data: $("#calendar-head").html()}
        });

    });

    function daysInMonth(month, year) {
        return new Date(year, month, 0).getDate();
    }

    var img_id;
    $(".img-droppable").click(function () {
        $(".modal-content #thumbnailContent").remove();
        $("#thumbnailContent").clone().appendTo($("#modalThumbnail .modal-content"));

        modalThumbnail.find(".img-picker").click(function () {
            modalThumbnail.css("display", "none");
            $('#' + img_id).find("img").attr('src', this.src);
        });

        // Remove button change image
        modalThumbnail.find(".img-plus").css('display', "none");

        modalThumbnail.css("display", "block");
        img_id = this.id;
    });


    function setImageChoose(id, elmnt) {
        $("#" + id).attr("src",$(elmnt).attr('src'));
        modalImage.css("display", "none");
    }

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
        modalCalendar.css("display", "none");
    }
    span2.onclick = function() {
        modalThumbnail.css("display", "none");
    }
    span3.onclick = function() {
        modalImage.css("display", "none");
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function (event) {
        
        if (event.target == modalCalendar) {
            modalCalendar.css("display", "none");
        }
        if (event.target == modalThumbnail) {
            modalThumbnail.css("display", "none");
        }
        if (event.target == modalImage) {
            modalImage.css("display", "none");
        }
    }

</script>

</body>
</html>
